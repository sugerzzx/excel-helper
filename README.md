# Excel Helper

基于 `egui` / `eframe` 的桌面工具，可以在 Windows 等桌面平台上将 Excel 按指定行数拆分为两个独立文件，并自动保留表头。

## 快速开始

```bash
# 运行调试版本
cargo run

# 运行优化后的版本（推荐给最终用户）
cargo run --release
```

程序启动后：

1. 点击“选择 Excel 文件”挑选需要处理的工作簿（`xlsx`/`xls`）。
2. 在“拆分行数”输入框里填写每个文件最多包含的数据行数。
3. 点击“拆分 (Split)”即可开始处理，状态栏会实时提示结果与输出文件路径。

## 功能特性

- 使用 `rfd` 系统文件对话框，体验与本地应用一致。
- 内置中文字体回退逻辑，避免界面中文显示为乱码。
- 自动读取首个工作表，按行拆分并通过 `rust_xlsxwriter` 写回标准 `xlsx` 文件。
- 通过 `poll-promise` 后台线程处理大文件，界面不会卡死。

## 目录结构

- `src/app.rs`: 图形界面与交互逻辑。
- `src/excel.rs`: Excel 读取、拆分、写回的核心算法。
- `src/main.rs`: 程序入口，负责启动 `eframe`。

如需扩展（例如多工作表选择、更多导出选项），可以在现有模块上继续拆分新的组件。
